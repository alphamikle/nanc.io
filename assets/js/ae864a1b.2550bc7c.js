"use strict";(self.webpackChunknanc_docs=self.webpackChunknanc_docs||[]).push([[3564],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>g});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),d=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=d(e.components);return r.createElement(l.Provider,{value:n},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=d(t),m=a,g=p["".concat(l,".").concat(m)]||p[m]||c[m]||i;return t?r.createElement(g,o(o({ref:n},u),{},{components:t})):r.createElement(g,o({ref:n},u))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[p]="string"==typeof e?e:a,o[1]=s;for(var d=2;d<i;d++)o[d]=t[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7895:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var r=t(7462),a=(t(7294),t(3905));const i={sidebar_position:2},o="Custom widgets",s={unversionedId:"nui/custom_widgets",id:"nui/custom_widgets",title:"Custom widgets",description:"There can be many reasons for adding a new widget type (with the corresponding tag addition) - lack of an implemented widget list, complex and specific animations that can only be implemented directly in Dart, or equally complex logic. In this example, we will look at the process of adding a new widget that will be responsible for displaying SVG images.",source:"@site/docs/nui/custom_widgets.md",sourceDirName:"nui",slug:"/nui/custom_widgets",permalink:"/docs/nui/custom_widgets",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/nui/custom_widgets.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Server Driven UI",permalink:"/docs/nui/server_driven_ui"},next:{title:"Slivers",permalink:"/docs/nui/slivers"}},l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Tag renderer",id:"tag-renderer",level:2},{value:"Builder",id:"builder",level:3},{value:"Widget tag",id:"widget-tag",level:4},{value:"Arguments extraction",id:"arguments-extraction",level:4},{value:"Rich renderer",id:"rich-renderer",level:4},{value:"Properties renderer",id:"properties-renderer",level:2},{value:"Complex properties",id:"complex-properties",level:3},{value:"Documentation",id:"documentation",level:2},{value:"Description",id:"description",level:3},{value:"Arguments",id:"arguments",level:3},{value:"Properties",id:"properties",level:3},{value:"Example",id:"example",level:3},{value:"Final renderer code",id:"final-renderer-code",level:3}],u={toc:d},p="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(p,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"custom-widgets"},"Custom widgets"),(0,a.kt)("p",null,"There can be many reasons for adding a new widget type (with the corresponding tag addition) - lack of an implemented widget list, complex and specific animations that can only be implemented directly in Dart, or equally complex logic. In this example, we will look at the process of adding a new widget that will be responsible for displaying SVG images."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("p",null,"In order for you to create your own tagged widget, you need to install the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"../modules/nui"},(0,a.kt)("inlineCode",{parentName:"a"},"nui")))," package."),(0,a.kt)("h2",{id:"tag-renderer"},"Tag renderer"),(0,a.kt)("p",null,"The second step is to create a tag renderer."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:flutter_svg/flutter_svg.dart';\nimport 'package:nanc_icons/nanc_icons.dart';\nimport 'package:nui/nui.dart';\n\nTagRenderer svgRenderer() {\n  return TagRenderer(\n    icon: IconPack.mdi_svg,\n    tagType: TagType.widget,\n    tag: 'svg',\n    description: const TagDescription(\n      description: '',\n      arguments: [],\n      properties: [],\n    ),\n    example: '',\n    builder: (BuildContext context, WidgetTag element, RichRenderer richRenderer) {\n      return SvgPicture.asset('some_path');\n    },\n  );\n}\n")),(0,a.kt)("p",null,"First, let's look at the renderer preset: it's an instance of the ",(0,a.kt)("inlineCode",{parentName:"p"},"TagRenderer")," class with several fields:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Icon (can be any icon in ",(0,a.kt)("inlineCode",{parentName:"li"},"IconData")," format."),(0,a.kt)("li",{parentName:"ul"},"Tag type; in this case it's a regular ",(0,a.kt)("inlineCode",{parentName:"li"},"widget"),", what other types there are we'll look at next."),(0,a.kt)("li",{parentName:"ul"},"Tag - this is the very tag, writing which in XML code you will see your widget. Let us draw your attention to the fact that in one application there can be only one tag with a certain name at a time. Therefore, if you decide to add a new renderer with a tag that already exists - you will get a build error."),(0,a.kt)("li",{parentName:"ul"},"Description is an interactive documentation for your tag, we will also dwell on it in detail, but later."),(0,a.kt)("li",{parentName:"ul"},"Example is part of the interactive documentation."),(0,a.kt)("li",{parentName:"ul"},"Builder - a function that returns some widget or null. We will start with its analysis.")),(0,a.kt)("h3",{id:"builder"},"Builder"),(0,a.kt)("h4",{id:"widget-tag"},"Widget tag"),(0,a.kt)("p",null,"Builder takes three parameters as an argument. There is no point in dwelling on the context, so let's go straight to ",(0,a.kt)("inlineCode",{parentName:"p"},"WidgetTag")," - this is a representation of the tag itself, in accordance with which you create your widget. The ",(0,a.kt)("inlineCode",{parentName:"p"},"WidgetTag")," contains the arguments you specified in the xml code, as well as references to its descendants."),(0,a.kt)("p",null,"For example, such xml code would yield the following list of arguments:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<svg ref="https://cdn.ourhost.com/svg_icons/123.svg" color="red"/>\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"final Map<String, String> arguments = element.arguments;")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "ref": "https://cdn.ourhost.com/svg_icons/123.svg",\n  "color": "red"\n}\n')),(0,a.kt)("p",null,"As you understand from this example - only one value is matched to one parameter."),(0,a.kt)("h4",{id:"arguments-extraction"},"Arguments extraction"),(0,a.kt)("p",null,"Let's extend our example and write a DTO in which we will collect all the values of the arguments we are going to process:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:json_annotation/json_annotation.dart';\nimport 'package:nui/nui.dart';\nimport 'package:nanc_tools/nanc_tools.dart';\n\npart 'svg_arguments.g.dart';\n\n@JsonSerializable()\nclass SvgArguments {\n  const SvgArguments({\n    required this.ref,\n    required this.vec,\n    required this.height,\n    required this.width,\n    required this.size,\n    required this.alignment,\n    required this.package,\n    required this.fit,\n    required this.drawOutside,\n    required this.clip,\n    required this.color,\n    required this.matchTextDirection,\n  });\n\n  factory SvgArguments.fromJson(dynamic json) => _$SvgArgumentsFromJson(castToJson(json));\n\n  final String? ref;\n  final String? vec;\n\n  @JsonKey(fromJson: nullableDoubleFromJson)\n  final double? height;\n\n  @JsonKey(fromJson: nullableDoubleFromJson)\n  final double? width;\n\n  @JsonKey(fromJson: nullableDoubleFromJson)\n  final double? size;\n\n  @JsonKey(unknownEnumValue: JsonKey.nullForUndefinedEnumValue)\n  final AlignmentEnum? alignment;\n\n  final String? package;\n\n  @JsonKey(unknownEnumValue: JsonKey.nullForUndefinedEnumValue)\n  final BoxFit? fit;\n\n  @JsonKey(fromJson: nullableBoolFromJson)\n  final bool? drawOutside;\n\n  final Clip? clip;\n\n  @JsonKey(fromJson: nullableColorFromJson, toJson: colorToJson)\n  final Color? color;\n\n  @JsonKey(fromJson: nullableBoolFromJson)\n  final bool? matchTextDirection;\n\n  Json toJson() => _$SvgArgumentsToJson(this);\n}\n")),(0,a.kt)("p",null,"As you can see, ready functions for field serialization / deserialization are actively used here, and in addition - all fields of our DTO are optional. It is highly recommended to always make all fields optional, as any of the arguments may not be present in the XML code. You can get ready functions for serialization / deserialization from the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"../modules/nanc_tools"},(0,a.kt)("inlineCode",{parentName:"a"},"nanc_tools")))," package."),(0,a.kt)("p",null,"Let's take a look at the updated renderer:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:flutter_svg/flutter_svg.dart';\nimport 'package:nanc_icons/nanc_icons.dart';\nimport 'package:nui/nui.dart';\n\nimport 'svg_arguments.dart';\n\nTagRenderer svgRenderer() {\n  return TagRenderer(\n    icon: IconPack.mdi_svg,\n    tagType: TagType.widget,\n    tag: 'svg',\n    description: const TagDescription(\n      description: '',\n      arguments: [],\n      properties: [],\n    ),\n    example: '',\n    builder: (BuildContext context, WidgetTag element, RichRenderer richRenderer) {\n      final SvgArguments arguments = SvgArguments.fromJson(element.attributes);\n\n      if (arguments.ref == null || arguments.ref!.isEmpty) {\n        return null;\n      }\n\n      return SvgPicture.asset(\n        arguments.ref!,\n        height: arguments.size ?? arguments.height,\n        width: arguments.size ?? arguments.width,\n        alignment: arguments.alignment?.toAlignment() ?? Alignment.center,\n        fit: arguments.fit ?? BoxFit.contain,\n        allowDrawingOutsideViewBox: arguments.drawOutside ?? false,\n        clipBehavior: arguments.clip ?? Clip.hardEdge,\n        matchTextDirection: arguments.matchTextDirection ?? false,\n      );\n    },\n  );\n}\n")),(0,a.kt)("p",null,"That's it! If we were creating a fairly simple widget that has no descendants, and no complex parameters, then that would be the end of our custom renderer creation, and we would only have to use it in the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/docs/cms_configuration"},"Cms configuration"))," and the ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/docs/app_configuring"},(0,a.kt)("inlineCode",{parentName:"a"},"NuiListWidget")))," or ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"/docs/app_configuring"},(0,a.kt)("inlineCode",{parentName:"a"},"NuiStackWidget")))," mobile application widgets."),(0,a.kt)("p",null,"Also, note how the absence of the mandatory argument ",(0,a.kt)("inlineCode",{parentName:"p"},"ref")," is handled - it may still be missing in the DTO and in this case our renderer will just return ",(0,a.kt)("inlineCode",{parentName:"p"},"null"),", but if this argument is present - we can already build our widget and return it."),(0,a.kt)("h4",{id:"rich-renderer"},"Rich renderer"),(0,a.kt)("p",null,"What if you need to handle more complex widget parameters than the usual scalar variables or ",(0,a.kt)("inlineCode",{parentName:"p"},"enum"),"s? For example - a list of headers to get an SVG image over the network, or creating a parameter like ",(0,a.kt)("inlineCode",{parentName:"p"},"ColorFilter"),"?"),(0,a.kt)("p",null,"This is where the third parameter of the ",(0,a.kt)("inlineCode",{parentName:"p"},"builder")," function - ",(0,a.kt)("inlineCode",{parentName:"p"},"RichRenderer")," - comes to our aid. The main task of this class is to render widgets from tags. Where to get these tags? Well - ",(0,a.kt)("inlineCode",{parentName:"p"},"WidgetTag")," contains not only a description of itself, but also references to its descendants, which we can render."),(0,a.kt)("p",null,"This can be useful if you are creating a complex widget that may have descendant widgets. What about complex parameters?"),(0,a.kt)("p",null,"This is where ",(0,a.kt)("inlineCode",{parentName:"p"},"RichRenderer")," is helped by the auxiliary class ",(0,a.kt)("inlineCode",{parentName:"p"},"PropertiesExtractor"),", which takes widgets processed by ",(0,a.kt)("inlineCode",{parentName:"p"},"RichRenderer")," as input and can filter out those that are special widgets containing data."),(0,a.kt)("p",null,"Also, to make it clear which parameters we can and are going to extract, we need to write a handler for the corresponding parameter. This is almost similar to the ",(0,a.kt)("inlineCode",{parentName:"p"},"TagRenderer")," concept, but somewhat simpler. Let's look at it on the example of both headers and color filter."),(0,a.kt)("h2",{id:"properties-renderer"},"Properties renderer"),(0,a.kt)("h3",{id:"complex-properties"},"Complex properties"),(0,a.kt)("p",null,"Header property:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:nui/nui.dart';\n\nimport 'header_arguments.dart';\nimport 'headers_property_widget.dart';\n\ntypedef Header = MapEntry<String, String>;\n\nconst String header = 'header';\n\nPropertyTagRenderer<Header> headerProperty({String name = header}) {\n  return PropertyTagRenderer(\n    tag: name,\n    builder: (BuildContext context, WidgetTag element, RichRenderer renderer) {\n      final HeaderArguments headerArguments = HeaderArguments.fromJson(element.attributes);\n\n      if (headerArguments.isEmpty) {\n        return null;\n      }\n\n      return HeadersPropertyWidget(\n        name: name,\n        property: MapEntry(headerArguments.name!, headerArguments.value!),\n      );\n    },\n  );\n}\n")),(0,a.kt)("p",null,"Header property arguments:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:json_annotation/json_annotation.dart';\nimport 'package:nanc_tools/nanc_tools.dart';\n\npart 'header_arguments.g.dart';\n\n@JsonSerializable()\nclass HeaderArguments {\n  const HeaderArguments({\n    required this.name,\n    required this.value,\n  });\n\n  factory HeaderArguments.fromJson(dynamic json) => _$HeaderArgumentsFromJson(castToJson(json));\n\n  final String? name;\n  final String? value;\n\n  bool get isEmpty => name == null || value == null || name!.isEmpty || value!.isEmpty;\n\n  Json toJson() => _$HeaderArgumentsToJson(this);\n}\n")),(0,a.kt)("p",null,"Header property widget:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:nui/nui.dart';\n\nimport 'header_property.dart';\n\nclass HeaderPropertyWidget extends PropertyWidget<Header> {\n  const HeaderPropertyWidget({\n    required super.name,\n    required super.property,\n    super.key,\n  });\n}\n")),(0,a.kt)("p",null,"What do network headers typically represent? It is some kind of object (Map), with a key - the name of the header, and a value - the value of the header. So we can build the resulting object with all the headers from the constituent parts \u2013 ",(0,a.kt)("inlineCode",{parentName:"p"},"MapEntry"),"s. And the brick of this puzzle will be one parameter \u2013 ",(0,a.kt)("inlineCode",{parentName:"p"},"header"),"."),(0,a.kt)("p",null,"Let's take a look at the resulting widget renderer we have at the moment:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:flutter_svg/flutter_svg.dart';\nimport 'package:nanc_icons/nanc_icons.dart';\nimport 'package:nui/nui.dart';\nimport 'package:vector_graphics/vector_graphics.dart';\n\nimport 'properties/color_filter/color_filter_property.dart';\nimport 'properties/header/header_property.dart';\nimport 'svg_arguments.dart';\n\nTagRenderer svgRenderer() {\n  return TagRenderer(\n    icon: IconPack.mdi_svg,\n    tagType: TagType.widget,\n    tag: 'svg',\n    description: const TagDescription(\n      description: '',\n      arguments: [],\n      properties: [],\n    ),\n    example: '',\n    builder: (BuildContext context, WidgetTag element, RichRenderer richRenderer) {\n      final SvgArguments arguments = SvgArguments.fromJson(element.attributes);\n\n      if (arguments.ref == null || arguments.ref!.isEmpty) {\n        return null;\n      }\n\n      final String ref = arguments.ref!;\n      final bool isNetworkLink = ref.startsWith('http');\n      \n      /// Creating the extractor, to be able extract properties widgets and the UI widgets separately\n      ///                       \u2b07\ufe0e  \u2b07\ufe0e  \u2b07\ufe0e                                                     Rendering all the children of current tag\n      ///                                                                                                   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e\n      final PropertiesExtractor extractor = PropertiesExtractor(context: context, rawChildren: richRenderer.renderChildren(context, element.children));\n\n      return SvgPicture(\n        isNetworkLink\n            ? SvgNetworkLoader(\n                ref,\n                /// Here we are building our Map<String, String> from [header] properties\n                ///      \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e   \u2b07\ufe0e \n                headers: Map.fromEntries(extractor.getProperties(header)),\n              )\n            : SvgAssetLoader(\n                ref,\n                packageName: arguments.package,\n              ),\n        height: arguments.size ?? arguments.height,\n        width: arguments.size ?? arguments.width,\n        alignment: arguments.alignment?.toAlignment() ?? Alignment.center,\n        fit: arguments.fit ?? BoxFit.contain,\n        allowDrawingOutsideViewBox: arguments.drawOutside ?? false,\n        clipBehavior: arguments.clip ?? Clip.hardEdge,\n        matchTextDirection: arguments.matchTextDirection ?? false,\n      );\n    },\n  );\n}\n")),(0,a.kt)("p",null,"Let's speed things up a bit and implement the ",(0,a.kt)("inlineCode",{parentName:"p"},"ColorFilter")," property:"),(0,a.kt)("p",null,"Color filter property:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:nui/nui.dart';\n\nimport 'color_filter_arguments.dart';\nimport 'color_filter_property_widget.dart';\n\nconst String colorFilter = 'colorFilter';\n\nPropertyTagRenderer<ColorFilter> colorFilterProperty({String name = colorFilter}) {\n  return PropertyTagRenderer(\n    tag: name,\n    builder: (BuildContext context, WidgetTag element, RichRenderer renderer) {\n      final ColorFilterArguments arguments = ColorFilterArguments.fromJson(element.attributes);\n\n      if (arguments.color == null || arguments.mode == null) {\n        return null;\n      }\n\n      return ColorFilterPropertyWidget(\n        name: name,\n        property: ColorFilter.mode(arguments.color!, arguments.mode!),\n      );\n    },\n  );\n}\n")),(0,a.kt)("p",null,"Color filter arguments:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:json_annotation/json_annotation.dart';\nimport 'package:nanc_tools/nanc_tools.dart';\n\npart 'color_filter_arguments.g.dart';\n\n@JsonSerializable()\nclass ColorFilterArguments {\n  const ColorFilterArguments({\n    required this.color,\n    required this.mode,\n  });\n\n  factory ColorFilterArguments.fromJson(dynamic json) => _$ColorFilterArgumentsFromJson(castToJson(json));\n\n  @JsonKey(fromJson: nullableColorFromJson, toJson: colorToJson)\n  final Color? color;\n\n  @JsonKey(unknownEnumValue: JsonKey.nullForUndefinedEnumValue)\n  final BlendMode? mode;\n\n  Json toJson() => _$ColorFilterArgumentsToJson(this);\n}\n")),(0,a.kt)("p",null,"Color filter property widget:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:nui/nui.dart';\n\nclass ColorFilterPropertyWidget extends PropertyWidget<ColorFilter> {\n  const ColorFilterPropertyWidget({\n    required super.name,\n    required super.property,\n    super.key,\n  });\n}\n")),(0,a.kt)("p",null,"In general terms, there is no difference with headers. But there is in the application in the widget renderer."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:flutter_svg/flutter_svg.dart';\nimport 'package:nanc_icons/nanc_icons.dart';\nimport 'package:nui/nui.dart';\n\nimport 'properties/color_filter/color_filter_property.dart';\nimport 'properties/header/header_property.dart';\nimport 'svg_arguments.dart';\n\nTagRenderer svgRenderer() {\n  return TagRenderer(\n    icon: IconPack.mdi_svg,\n    tagType: TagType.widget,\n    tag: 'svg',\n    description: const TagDescription(\n      description: '',\n      arguments: [],\n      properties: [],\n    ),\n    example: '',\n    builder: (BuildContext context, WidgetTag element, RichRenderer richRenderer) {\n      final SvgArguments arguments = SvgArguments.fromJson(element.attributes);\n      final PropertiesExtractor extractor = PropertiesExtractor(context: context, rawChildren: richRenderer.renderChildren(context, element.children));\n\n      if (arguments.ref == null || arguments.ref!.isEmpty) {\n        return null;\n      }\n\n      final String ref = arguments.ref!;\n      final bool isNetworkLink = ref.startsWith('http');\n\n      /// Extracting single property [ColorFilter] here \u2b07\ufe0e\n      ColorFilter? effectiveColorFilter = extractor.getProperty(colorFilter);\n\n      if (effectiveColorFilter == null && arguments.color != null) {\n        /// Using [color] argument, if we have no [ColorFilter] property with default blend mode\n        effectiveColorFilter = ColorFilter.mode(arguments.color!, BlendMode.srcIn);\n      }\n\n      return SvgPicture(\n        isNetworkLink\n            ? SvgNetworkLoader(\n                ref,\n                headers: Map.fromEntries(extractor.getProperties(header)),\n              )\n            : SvgAssetLoader(\n                ref,\n                packageName: arguments.package,\n              ),\n        height: arguments.size ?? arguments.height,\n        width: arguments.size ?? arguments.width,\n        alignment: arguments.alignment?.toAlignment() ?? Alignment.center,\n        fit: arguments.fit ?? BoxFit.contain,\n        allowDrawingOutsideViewBox: arguments.drawOutside ?? false,\n        clipBehavior: arguments.clip ?? Clip.hardEdge,\n        matchTextDirection: arguments.matchTextDirection ?? false,\n        /// Using final variant of parameter\n        colorFilter: effectiveColorFilter,\n      );\n    },\n  );\n}\n")),(0,a.kt)("p",null,"From this example, you could see that it is possible to use multiple parameters as well as one single parameter."),(0,a.kt)("p",null,"Well, it remains to go through the documentation..."),(0,a.kt)("h2",{id:"documentation"},"Documentation"),(0,a.kt)("h3",{id:"description"},"Description"),(0,a.kt)("p",null,"The documentation consists of two large sections - a description, and an example. The description, in turn, consists of, literally, a human description of the widget/tag you are creating. We advise you not to spare words and describe everything in such a way that you yourself could understand why this widget is needed a year later, and that a user who has no idea how to use Nanc or Flutter could still understand what we are talking about."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"description")," parameter of the ",(0,a.kt)("inlineCode",{parentName:"p"},"TagDescription")," class, by the way, accepts not just text - it is a full-fledged Markdown, and you can use all its features there, the list of which can be found in ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"https://pub.dev/packages/flutter_markdown"},"this package")),"."),(0,a.kt)("h3",{id:"arguments"},"Arguments"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"arguments")," parameter allows you to describe all the arguments (simple variables, scalar type or ",(0,a.kt)("inlineCode",{parentName:"p"},"enum"),") that your tag will accept. Basically the rule of thumb for naming arguments is to name them the same way they are named in the Flutter API, or the libraries whose widgets you want to implement as tags. But sometimes the names can be made much simpler, and the arguments can be expanded to make using the tag easier and more enjoyable."),(0,a.kt)("p",null,"In our case, one such extended argument is ",(0,a.kt)("inlineCode",{parentName:"p"},"color")," - an argument that is considered ",(0,a.kt)("inlineCode",{parentName:"p"},"deprecated")," in the original ",(0,a.kt)("inlineCode",{parentName:"p"},"SvgPicture")," widget, but it is much easier to specify just color instead of the more complex ",(0,a.kt)("inlineCode",{parentName:"p"},"colorFilter")," parameter, which is what was implemented."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"nui")," library contains an extensive list of implemented arguments, and you can use them to document your custom widgets. And if something is missing, you can always create your own description for any argument using the ",(0,a.kt)("inlineCode",{parentName:"p"},"TagArgument")," class."),(0,a.kt)("h3",{id:"properties"},"Properties"),(0,a.kt)("p",null,"Properties are a more complex variety of argument parameters - they can both contain their own arguments, as you may have seen above, and other properties. The ",(0,a.kt)("inlineCode",{parentName:"p"},"TagProperty")," class allows you to document all aspects of using a property, its arguments, and child properties, if any."),(0,a.kt)("h3",{id:"example"},"Example"),(0,a.kt)("p",null,"In this field, you can create basic XML code that shows exactly how your freshly created widget / tag can be used. Try to show as many variations of tag usage as possible, so that it is clear which argument and parameter is responsible for what."),(0,a.kt)("p",null,'When the user turns to the interactive documentation of Nanc, he will be able both to read the whole description and to "feel" your tag and modify its code.'),(0,a.kt)("video",{src:"/videos/svg_documentation.mp4",controls:!0,width:"100%"}),(0,a.kt)("h3",{id:"final-renderer-code"},"Final renderer code"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-dart"},"import 'package:flutter/material.dart';\nimport 'package:flutter_svg/flutter_svg.dart';\nimport 'package:nanc_icons/nanc_icons.dart';\nimport 'package:nui/nui.dart';\nimport 'package:vector_graphics/vector_graphics.dart';\n\nimport 'properties/color_filter/color_filter_property.dart';\nimport 'properties/header/header_property.dart';\nimport 'svg_arguments.dart';\n\nTagRenderer svgRenderer() {\n  return TagRenderer(\n    icon: IconPack.mdi_svg,\n    tagType: TagType.widget,\n    tag: 'svg',\n    description: TagDescription(\n      description: '''\n# Svg\n\nA custom widget that allows you to use SVG images in your application.\nBoth located somewhere and located in the assets of your application.\nYou can also further optimize SVG images with a compiler.\nAnd use optimized versions. Details can be found at the following [link](https://pub.dev/packages/flutter_svg#precompiling-and-optimizing-svgs).\n      ''',\n      arguments: [\n        const TagArgument(\n          name: 'ref',\n          values: {'String', 'assets/svg_icons/star.svg', 'https://cdn.ourhost.com/svg_icons/star.svg'},\n          description: 'The path to the SVG file, or the network path, URL, to the SVG file.',\n        ),\n        const TagArgument(\n          name: 'vec',\n          values: {'String', 'assets/svg_icons/star.svg.vec', 'https://cdn.ourhost.com/svg_icons/star.svg.vec'},\n          description: '''\nPath to a file pre-compiled into a special vector format. Details are available at this [link](https://pub.dev/packages/flutter_svg#precompiling-and-optimizing-svgs).\n''',\n        ),\n        heightArgument(),\n        widthArgument(),\n        sizeArgument(),\n        alignmentArgument(name: 'alignment'),\n        packageArgument(),\n        boxFitArgument(name: 'fit'),\n        boolArgument(name: 'drawOutside'),\n        clipArgument(name: 'clip'),\n        boolArgument(name: 'matchTextDirection'),\n        colorArgument(name: 'color'),\n      ],\n      properties: [\n        const TagProperty(\n          name: header,\n          arguments: [\n            TagArgument(\n              name: 'name',\n              values: {'String', 'Cache-Control', 'Authorization'},\n            ),\n            TagArgument(\n              name: 'value',\n              values: {'String', 'no-cache', 'eyJhbGciOiJIUzI1NiIsInR'},\n            ),\n          ],\n          properties: [],\n        ),\n        TagProperty(\n          name: colorFilter,\n          arguments: [\n            colorArgument(name: 'color'),\n            blendModeArgument(name: 'mode'),\n          ],\n          properties: [],\n        ),\n      ],\n    ),\n    example: '''\n<safeArea>\n  <column>\n    <svg ref=\"https://raw.githubusercontent.com/FortAwesome/Font-Awesome/6.x/svgs/solid/0.svg\" color=\"green\" height=\"50\" width=\"50\"/>\n    <svg ref=\"https://raw.githubusercontent.com/FortAwesome/Font-Awesome/6.x/svgs/solid/1.svg\" size=\"50\">\n      <prop:header name=\"Cache-Control\" value=\"public\"/>\n      <prop:header name=\"ETag\" value=\"737060cd8c284d8af7ad3082f209582d\"/>\n      <prop:colorFilter color=\"yellow\" mode=\"color\"/>\n    </svg>\n    <for from=\"2\" to=\"10\">\n      <svg ref=\"https://raw.githubusercontent.com/FortAwesome/Font-Awesome/6.x/svgs/solid/{{ cycle.value }}.svg\" size=\"50\"/>\n    </for>\n  </column>\n</safeArea>\n''',\n    builder: (BuildContext context, WidgetTag element, RichRenderer richRenderer) {\n      final SvgArguments arguments = SvgArguments.fromJson(element.attributes);\n\n      if ((arguments.ref == null || arguments.ref!.isEmpty) && (arguments.vec == null || arguments.vec!.isEmpty)) {\n        return null;\n      }\n\n      final bool isVector = arguments.vec != null && arguments.vec!.isNotEmpty;\n      final String ref = isVector ? arguments.vec! : arguments.ref!;\n      final bool isNetworkLink = ref.startsWith('http');\n\n      final PropertiesExtractor extractor = PropertiesExtractor(context: context, rawChildren: richRenderer.renderChildren(context, element.children));\n\n      ColorFilter? effectiveColorFilter = extractor.getProperty(colorFilter);\n\n      if (effectiveColorFilter == null && arguments.color != null) {\n        effectiveColorFilter = ColorFilter.mode(arguments.color!, BlendMode.srcIn);\n      }\n\n      if (isVector) {\n        return SvgPicture(\n          isNetworkLink\n              ? NetworkBytesLoader(\n                  Uri.parse(ref),\n                  headers: Map.fromEntries(extractor.getProperties(header)),\n                )\n              : AssetBytesLoader(\n                  ref,\n                  packageName: arguments.package,\n                ),\n          height: arguments.size ?? arguments.height,\n          width: arguments.size ?? arguments.width,\n          alignment: arguments.alignment?.toAlignment() ?? Alignment.center,\n          fit: arguments.fit ?? BoxFit.contain,\n          allowDrawingOutsideViewBox: arguments.drawOutside ?? false,\n          clipBehavior: arguments.clip ?? Clip.hardEdge,\n          matchTextDirection: arguments.matchTextDirection ?? false,\n          colorFilter: effectiveColorFilter,\n        );\n      }\n\n      return SvgPicture(\n        isNetworkLink\n            ? SvgNetworkLoader(\n                ref,\n                headers: Map.fromEntries(extractor.getProperties(header)),\n              )\n            : SvgAssetLoader(\n                ref,\n                packageName: arguments.package,\n              ),\n        height: arguments.size ?? arguments.height,\n        width: arguments.size ?? arguments.width,\n        alignment: arguments.alignment?.toAlignment() ?? Alignment.center,\n        fit: arguments.fit ?? BoxFit.contain,\n        allowDrawingOutsideViewBox: arguments.drawOutside ?? false,\n        clipBehavior: arguments.clip ?? Clip.hardEdge,\n        matchTextDirection: arguments.matchTextDirection ?? false,\n        colorFilter: effectiveColorFilter,\n      );\n    },\n  );\n}\n")))}c.isMDXComponent=!0}}]);