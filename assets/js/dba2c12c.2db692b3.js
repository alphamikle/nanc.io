"use strict";(self.webpackChunknanc_docs=self.webpackChunknanc_docs||[]).push([[1051],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(n),h=o,m=u["".concat(s,".").concat(h)]||u[h]||p[h]||i;return n?a.createElement(m,r(r({ref:t},c),{},{components:n})):a.createElement(m,r({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},9308:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=n(7462),o=(n(7294),n(3905));const i={sidebar_position:1},r="Server Driven UI",l={unversionedId:"nui/server_driven_ui",id:"nui/server_driven_ui",title:"Server Driven UI",description:"Nanc Server Driven UI, called Nui here and later, allows you to implement an interface of almost any complexity out of the box. That being said, you can extend the widgets available to you very easily and do whatever you want.",source:"@site/docs/nui/server_driven_ui.md",sourceDirName:"nui",slug:"/nui/server_driven_ui",permalink:"/docs/nui/server_driven_ui",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/nui/server_driven_ui.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Server Driven UI",permalink:"/docs/category/server-driven-ui"},next:{title:"Custom widgets",permalink:"/docs/nui/custom_widgets"}},s={},d=[{value:"How to start",id:"how-to-start",level:2},{value:"Screen Field",id:"screen-field",level:3},{value:"Scrollable",id:"scrollable",level:4},{value:"Stack",id:"stack",level:4},{value:"UI syntax",id:"ui-syntax",level:2},{value:"Variables",id:"variables",level:3},{value:"Local variables",id:"local-variables",level:4},{value:"Parent context variables",id:"parent-context-variables",level:4},{value:"Implemented widgets",id:"implemented-widgets",level:2},{value:"Logic",id:"logic",level:2},{value:"Interactive documentation",id:"interactive-documentation",level:2},{value:"Synchronization with IDE",id:"synchronization-with-ide",level:2}],c={toc:d},u="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"server-driven-ui"},"Server Driven UI"),(0,o.kt)("p",null,"Nanc Server Driven UI, called ",(0,o.kt)("strong",{parentName:"p"},"Nui")," here and later, allows you to implement an interface of almost any complexity out of the box. That being said, you can extend the widgets available to you very easily and do whatever you want."),(0,o.kt)("p",null,"You have access to logical operators that hide or show interface elements, cycles, templating and variables - defined directly in the UI code and accessible from the outside - for example, the entire parent context of the document, one of the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/modules/nanc#fields"},"fields"))," of which is ",(0,o.kt)("inlineCode",{parentName:"p"},"Screen Field"),"."),(0,o.kt)("h2",{id:"how-to-start"},"How to start"),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Next, we will describe working with a special field - ",(0,o.kt)("inlineCode",{parentName:"p"},"Screen Field")," - a part of Nanc that is responsible for capabilities related to Server Driven UI. There is no need for you to use Nanc if you want to use Nui; however, learning about such capabilities will be useful.")),(0,o.kt)("p",null,"First you need to add the ",(0,o.kt)("strong",{parentName:"p"},"Screen")," field to your model. Depending on how it's created - with code or through the user interface - you'll use the appropriate paths. For the code you will need the ",(0,o.kt)("inlineCode",{parentName:"p"},"ScreenField")," class from the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/modules/nanc#fields"},"fields"))," module."),(0,o.kt)("p",null,"But we'll take a look at the approach to creating mobile application screens through the Nanc user interface."),(0,o.kt)("h3",{id:"screen-field"},"Screen Field"),(0,o.kt)("video",{src:"/videos/adding_screen_field.mp4",controls:!0,width:"100%"}),(0,o.kt)("p",null,"When adding a field, you must select the type of screen you want to add. Let's take a closer look at them."),(0,o.kt)("h4",{id:"scrollable"},"Scrollable"),(0,o.kt)("p",null,"This type corresponds to the usual vertically scrolling screen, which can be any number of interface elements. All the widgets you will add to this screen will be drawn as if you were adding them to the ",(0,o.kt)("inlineCode",{parentName:"p"},"SliverList"),". You can add sliver widgets to that list as well, and also, you are able to register your own sliver widgets with ",(0,o.kt)("inlineCode",{parentName:"p"},"sliverChecker")," property of ",(0,o.kt)("inlineCode",{parentName:"p"},"CmsConfig")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"NuiListWidget")," classes."),(0,o.kt)("p",null,"To show that type of UI in the app you should use ",(0,o.kt)("inlineCode",{parentName:"p"},"NuiListWidget"),"."),(0,o.kt)("p",null,"Below is an example of what your widget tree would look like if you decided to display your UI created in this mode yourself:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},"Widget build() {\n  final List<Widget> widgets = [/* YOUR WIDGETS HERE */];\n\n  return CustomScrollView(\n    slivers: [\n      SliverList(\n        delegate: SliverChildBuilderDelegate(\n          (BuildContext context, int index) => widgets[index],\n          childCount: widgets.length,\n        ),\n      ),\n    ],\n  );\n}\n")),(0,o.kt)("h4",{id:"stack"},"Stack"),(0,o.kt)("p",null,"In this mode, all widgets you add will be displayed in the parent widget type ",(0,o.kt)("inlineCode",{parentName:"p"},"Stack"),". This can be useful if you want to implement not just a scrolling list of something, but to add layering. Also, this mode allows you to implement not only screens as a minimal unit of visual functionality, but also individual small widgets that you can embed anywhere in your application as the most common widgets, but that you can completely change the appearance of these widgets at the initiative of the backend, thus updating your application."),(0,o.kt)("p",null,"To show that type of UI in the app you should use ",(0,o.kt)("inlineCode",{parentName:"p"},"NuiStackWidget"),"."),(0,o.kt)("p",null,"ANd below is an example of what your widget tree would look like if you decided to display your UI created in this mode yourself:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},"Widget build() {\n  final List<Widget> widgets = [/* YOUR WIDGETS HERE */];\n\n  return Stack(\n    fit: StackFit.expand,\n    children: widgets,\n  );\n}\n")),(0,o.kt)("h2",{id:"ui-syntax"},"UI syntax"),(0,o.kt)("p",null,"The syntax chosen is XML/HTML, with some simplifications and modifications (not many)."),(0,o.kt)("p",null,"The main simplification is that there is no requirement for your code to have a single root element. No matter what type your screen/component is - ",(0,o.kt)("inlineCode",{parentName:"p"},"Scrollable")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"Stack")," - you can describe your interface starting from the first element you want to display."),(0,o.kt)("p",null,"Now to the modifications - they don't change the XML syntax, but add to it. To access variables you should use the syntax ",(0,o.kt)("inlineCode",{parentName:"p"},"{{ ... }}"),", where instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"...")," is your expression or/and a reference to some variable."),(0,o.kt)("p",null,"For example, if there is a variable with the key ",(0,o.kt)("inlineCode",{parentName:"p"},"age")," and a primitive value in the parent context (to be discussed below), you could create a widget-text describing the age of something or someone as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<text>\n  This civilization age was {{ page.age }} centuries.\n</text>\n")),(0,o.kt)("p",null,"Another addition is a special expression for defining cycles. One way to draw something in a loop would be the following expression:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<for from="0" to="10">\n  <!- YOUR WIDGET --\x3e\n</for>\n')),(0,o.kt)("p",null,"The start and end of the loop can be any positive numbers. Next examples are correct too:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<for from="20" to="100">\n  <!- YOUR WIDGET --\x3e\n</for>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<for from="50" to="0">\n  <!- YOUR WIDGET --\x3e\n</for>\n')),(0,o.kt)("p",null,"Also, there is no strict requirement on exactly how you should close tags. For some widgets, you simply have no choice but to close them in a paired way - because the key argument of the widget (tag) must be inside the body of the tag, and not be a parameter, for example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<text>\n  Some text here\n</text>\n")),(0,o.kt)("p",null,"But for some tags, you can use a self-closing tag construct (also, as an paired variant):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<sizedBox height="12"/>\n\n<container height="1" color="#FFF77669"/>\n\n<container>\n  <padding all="8">\n    <text>\n      Some text here\n    </text>\n  </padding>\n</container>\n')),(0,o.kt)("h3",{id:"variables"},"Variables"),(0,o.kt)("h4",{id:"local-variables"},"Local variables"),(0,o.kt)("p",null,"You can define custom variables right in your UI code, which can be useful when setting common indents, font names, colors, roundings, and more. You should use the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," tag for this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<data left="16" top="12" right="16" bottom="32"/>\n<data gap.left="36" gap.top="36" gap.right="36" gap.bottom="36"/>\n<data namespace="props.colors" primary="red" secondary="green" tertiary="blue"/>\n<data colors.primary="red" colors.secondary="green" colors.tertiary="blue"/>\n<data colors.onPrimary="#FFFFFF" colors.onSecondary="#FAB1E8" colors.onTertiary="#CCFFDA"/>\n\n<padding left="{{ data.left }}" top="{{ data.gap.top }}">\n  <column>\n    <container color="{{ data.props.colors.primary }}" size="100"/>\n    <sizedBox height="{{ data.gap.bottom }}"/>\n    <container color="{{ data.colors.secondary }}" size="100"/>\n    <sizedBox height="{{ data.gap.top }}"/>\n    <container color="{{ data.colors.onTertiary }}" size="100"/>\n  </column>\n</padding>\n')),(0,o.kt)("h4",{id:"parent-context-variables"},"Parent context variables"),(0,o.kt)("p",null,'You, also, have access to the "parent context" - all fields of any type, in a parent object, one of whose fields is ',(0,o.kt)("inlineCode",{parentName:"p"},"Screen Field"),"."),(0,o.kt)("p",null,"Let's add some data to our test model to see how the interface can be handled in a data-driven approach:"),(0,o.kt)("video",{src:"/videos/parent_context.mp4",controls:!0,width:"100%"}),(0,o.kt)("p",null,"And here how it will looks like, if we want to put data in the mobile app:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},"Widget build() {\n  return NuiStackWidget(\n    renderers: const [],\n    imageErrorBuilder: null,\n    imageFrameBuilder: null,\n    imageLoadingBuilder: null,\n    binary: null,\n    nodes: null,\n    xmlContent: '''\n      <center>\n        <column mainAxisSize=\"min\">\n          <text size=\"18\">\n            You have pushed the button this many times:\n          </text>\n          <text size=\"32\">\n            {{ page.counter }}\n          </text>\n        </column>\n      </center>\n    ''',\n    /// \u2b07\ufe0e\u2b07\ufe0e Your data here \u2b07\ufe0e\u2b07\ufe0e\n    pageData: {\n      'counter': _counter,\n    },\n  );\n}\n")),(0,o.kt)("p",null,"As you have already realized, to access variables externally, you must use the ",(0,o.kt)("inlineCode",{parentName:"p"},"page")," keyword inside the double curly braces. You can refer to any nested element, at any level of nesting, say, if you have the following object:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json5"},'// Just for example - parent context contains a data, which describing some car\n{\n  "make": "Toyota",\n  "characteristics": [\n    {\n      "name": "engine",\n      "value": "V6 Turbo"\n    }\n  ]\n}\n')),(0,o.kt)("p",null,"You can easily get the name of the engine somewhere: ",(0,o.kt)("inlineCode",{parentName:"p"},"page.characteristics.0.value"),". In case you try to refer to some variable, at any depth, that does not exist - you will get ",(0,o.kt)("inlineCode",{parentName:"p"},"null")," as a result: ",(0,o.kt)("inlineCode",{parentName:"p"},"page.characteristics.3.value.some.another.prop")," will be returned as ",(0,o.kt)("inlineCode",{parentName:"p"},"null"),"."),(0,o.kt)("h2",{id:"implemented-widgets"},"Implemented widgets"),(0,o.kt)("p",null,"Currently implemented quite a large list of standard widgets that you can use to build the UI. This list will be constantly expanding until it covers all implemented widgets from the Flutter standard library. You can find out the full list in Nanc by adding ",(0,o.kt)("inlineCode",{parentName:"p"},"ScreenField")," to some model, then start editing it and go to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Help")," section by the button on the top right."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"In some time later, here will be provided a direct link to the interactive Nanc documentation.")),(0,o.kt)("h2",{id:"logic"},"Logic"),(0,o.kt)("p",null,"Nanc supports many ways to achieve interactivity - handling custom clicks/taps, long presses, gestures, creating and destroying widgets on the screen. You can come up with your own and implement them. In any case, the event you can catch and handle is a simple string that will be passed to the event handler when some action happens (click, long tap, widget appears, etc). In this example, we will understand the handling of an event that occurs when a user clicks on a screen element:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<inkWell onPressed="addToCart:{{ page.product_id }}">\n  <container>\n    <center>\n      <text>\n        Buy\n      </text>\n    </center>\n  </container>\n</inkWell>\n')),(0,o.kt)("p",null,"The value of the ",(0,o.kt)("inlineCode",{parentName:"p"},"onPressed")," parameter - within the framework of Nanc concepts, is called an event. Event can be any string, and you can assign handlers for any events. Say, you can make a handler for events starting with the string ",(0,o.kt)("inlineCode",{parentName:"p"},"addToCart:"),"."),(0,o.kt)("p",null,"The event handler is a special ",(0,o.kt)("inlineCode",{parentName:"p"},"EventHandler")," class that you can import from the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"../modules/nanc_configuration"},"config"))," package."),(0,o.kt)("p",null,"Having implemented the required ",(0,o.kt)("inlineCode",{parentName:"p"},"EventHandler"),"s - you must implement them in your widget tree via another widget called ",(0,o.kt)("inlineCode",{parentName:"p"},"EventDelegate"),", which you can import from the ",(0,o.kt)("inlineCode",{parentName:"p"},"nui")," package - the package required for your mobile application that is going to render the ",(0,o.kt)("strong",{parentName:"p"},"Nui"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dart"},"Widget build() {\n  return EventDelegate(\n    handlers: [\n      browserLinksHandler,\n      snackbarHandler,\n      deeplinkHandler,\n      addToCardHandler,\n      // ...\n      // List of your own handlers\n    ],\n    child: MaterialApp(/*...*/), // You can place in near to the top of your widget tree\n  );\n}\n")),(0,o.kt)("p",null,"If you approach the design of events handlers with foresight, you can implement very complex user scenarios, say - by implementing an event handling queue:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<inkWell onPressed=\"(addToCart:12345 then showNotification:'You successfully added product to your cart!') or somethingElse\">\n  <productCard/>\n</inkWell>\n")),(0,o.kt)("p",null,"You are free to determine how you label events, what they will be, and what you can do with them."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Also, you may want to consider just specifying an identifier as the event, the corresponding handler will take that identifier, go to the backend, and get all the necessary arguments from that identifier that you would otherwise have to specify in the event itself.")),(0,o.kt)("h2",{id:"interactive-documentation"},"Interactive documentation"),(0,o.kt)("p",null,"As mentioned above - Nanc has built-in interactive documentation for each widget implemented as a tag, and each widget parameter. We will intentionally not list all of them here to encourage you to use the built-in Nanc documentation. We will only repeat how you can get acquainted with it:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create your first model"),(0,o.kt)("li",{parentName:"ul"},"Add ",(0,o.kt)("inlineCode",{parentName:"li"},"ScreenField")," to this model"),(0,o.kt)("li",{parentName:"ul"},"Create the first document of the corresponding model"),(0,o.kt)("li",{parentName:"ul"},"Start editing the previously created ",(0,o.kt)("inlineCode",{parentName:"li"},"ScreenField")," field"),(0,o.kt)("li",{parentName:"ul"},"Go to the ",(0,o.kt)("inlineCode",{parentName:"li"},"Help")," section by clicking the appropriate button on the top right")),(0,o.kt)("video",{src:"/videos/screen_field_help.mp4",controls:!0,width:"100%"}),(0,o.kt)("h2",{id:"synchronization-with-ide"},"Synchronization with IDE"),(0,o.kt)("p",null,"At the moment, the built-in code editor in Nanc is, frankly and crappy. In addition, if you are a developer, it will be much more convenient for you to develop a new screen or component in Nanc in your favorite and cozy IDE. That's why Nanc supports this feature - you can sync Nanc's screen editor with any file on your file system. It doesn't matter if Nanc is running in your browser, deployed somewhere, or if you run it locally under a desktop platform (Mac / Windows / Linux). But, don't forget - to have this ability in web-environment, you should ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/cms_configuration#web-app-configuration"},"install"))," additional thing too."),(0,o.kt)("p",null,"To understand what the essence is, you can watch the following video:"),(0,o.kt)("video",{src:"/videos/sync_with_ide.mp4",controls:!0,width:"100%"}))}p.isMDXComponent=!0}}]);